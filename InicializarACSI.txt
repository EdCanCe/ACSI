create database ACSI;
use ACSI;

create table Alumnos(
NoControl bigint NOT NULL PRIMARY KEY,
CURPAl char(18) NOT NULL,
NombreAl varchar(30) NOT NULL,
ApPaternoAl varchar(20) NOT NULL,
ApMaternoAl varchar(20),
TipoSangre varchar(3) default '--',
Alergias varchar(100) default 'Ninguna.',
NombreTut varchar(30),
ApPaternoTut varchar(20),
ApMaternoTut varchar(20),
NoTelefonoTut bigint,
FechaNacAl date);

create table Medicina(
MedicinaID int NOT NULL AUTO_INCREMENT PRIMARY KEY,
NombreMed varchar(20) NOT NULL,
ComponenteAct varchar(70) NOT NULL,
GramajeMed varchar(40) NOT NULL,
FotoMed longblob,
CantidadMedicina int DEFAULT 0);

create table Doctor(
CedulaProf char(8) NOT NULL PRIMARY KEY,
HoraEntrada time NOT NULL,
HoraSalida time NOT NULL,
InstitutoEgreso varchar(40) NOT NULL,
Especialidad varchar(20) default 'Medico Cirujano',
NombreDoc varchar(30) NOT NULL,
ApPaternoDoc varchar(20) NOT NULL,
ApMaternoDoc varchar(20));

create table Receta(
NoConsulta bigint NOT NULL AUTO_INCREMENT PRIMARY KEY,
NoControlFK bigint,
CedulaProfFK char(8),
CONSTRAINT NoControlFK FOREIGN KEY (NoControlFK)
REFERENCES Alumnos(NoControl),
CONSTRAINT CedulaProfFK FOREIGN KEY (CedulaProfFK)
REFERENCES Doctor(CedulaProf),
Padecimientos text NOT NULL,
Diagnostico text NOT NULL,
TempPaciente float,
Dosis text,
Diagnostico text,
Fecha TimeStamp NOT NULL,
PesoPaciente float,
Altura float);

create table CantidadesMed(
CantidadesID bigint NOT NULL AUTO_INCREMENT PRIMARY KEY,
Cantidad int NOT NULL,
MedicinaIDFK int,
CONSTRAINT MedicinaIDFK FOREIGN KEY (MedicinaIDFK)
REFERENCES Medicina(MedicinaID),
NoConsultaFK bigint,
CONSTRAINT NoConsultaFK FOREIGN KEY (NoConsultaFK)
REFERENCES Receta(NoConsulta));

create table Cuenta(
CuentaID bigint NOT NULL AUTO_INCREMENT PRIMARY KEY,
Usuario varchar(15) NOT NULL,
Pass varchar(15) NOT NULL,
TipoCuenta bool default 0,
CedulaDocFK char(8),
CONSTRAINT CedulaDocFK FOREIGN KEY (CedulaDocFK)
REFERENCES Doctor(CedulaProf));

ALTER TABLE Cuenta AUTO_INCREMENT=100000000;

create table Pregunta(
PreguntaID bigint NOT NULL AUTO_INCREMENT PRIMARY KEY,
ContenidoPreg varchar(150) NOT NULL,
AutorPregFK bigint,
CONSTRAINT AutorPregFK FOREIGN KEY (AutorPregFK)
REFERENCES Cuenta(CuentaID));

create table Respuesta(
RespuestaID bigint NOT NULL AUTO_INCREMENT PRIMARY KEY,
ContenidoResp varchar(150) NOT NULL,
PreguntaFK bigint,
Votos bigint,
CONSTRAINT PreguntaFK FOREIGN KEY (PreguntaFK)
REFERENCES Pregunta(PreguntaID),
UsuarioResp bigint,
CONSTRAINT UsuarioResp FOREIGN KEY (UsuarioResp)
REFERENCES Cuenta(CuentaID),
AutorLike bool default 0);

create table Votos(
VotoID bigint NOT NULL AUTO_INCREMENT PRIMARY KEY,
RespuestaFK bigint,
CONSTRAINT RespuestaFK FOREIGN KEY (RespuestaFK)
REFERENCES Respuesta(RespuestaID),
UsuarioVot bigint,
CONSTRAINT UsuarioVot FOREIGN KEY (UsuarioVot)
REFERENCES Cuenta(CuentaID));

create table Blog(
EntradaID bigint NOT NULL AUTO_INCREMENT PRIMARY KEY,
ContenidoEnt varchar(150) NOT NULL,
FotoEnt longblob);
